#+Property: :exports results :results replace
#+STYLE: <link rel="stylesheet" type="text/css" href="./worg.css" />
#+OPTIONS: ^:nil num:nil
#+TITLE: suboptimal

* Welcome

This is a blog for Noah Hoffman. 

#+BEGIN_SRC python :results output raw :exports results
  import glob
  import collections
  import json
  import os
  
  # link and page count for each post
  tags = collections.defaultdict(list)
  jfiles = glob.glob('build/*.json')
  for jfile in jfiles:
      with open(jfile) as j:
          d = json.load(j)
      for tag in d['tags'].split(','):
          tags[tag].append(d)
  
  print 'Topics: [[file:./index.html][all]] (%s)' % len(jfiles),
  for tag, posts in sorted(tags.items()):
      print '[[file:./%s.html][%s]] (%s)' % (tag, tag, len(posts)),
  print
  
  # include section each specified post
  posts = os.environ.get('POSTS','').split()
  
  for basename in posts:
      with open('build/%s.json' % basename) as j:
          props = json.load(j)
  
      print '* %(title)s' % props
      print 'Posted %(date)s ([[file:%(basename)s.html][single post]])' % props
  
      with open(props['body']) as h:
          print '#+BEGIN_HTML\n%s\n#+END_HTML' % h.read()
  
      print 'Filed under *%(tags)s*' % props
#+END_SRC

* About

This site is constructed mostly using emacs org-mode as an excuse to
learn some emacs lisp. The css stylesheet is derived from the file
http://orgmode.org/worg/style/worg.css, which is provided under the
GNU General Public License v3.
